# Numerical Integration

## The **trapezoidal rule**,

$$
\int_{x_0}^{x_n} y(x)\, dx \approx \frac{1}{2}h(y_0 + 2y_1 + \cdots + 2y_{n-1} + y_n)
$$

is an elementary, but typical, **composite numerical integration formula**, known as the **composite trapezoidal rule**. This rule approximates the area under the curve $y(x)$ over the interval $[x_0, x_n]$ by dividing the interval into $n$ equal subintervals of width $h = \frac{x_n - x_0}{n}$, and using **straight line segments** to connect successive points $(x_i, y_i)$. These segments form trapezoids, whose areas are straightforward to compute.

The formula effectively replaces the integrand $y(x)$ with a piecewise linear function, interpolating $y(x)$ at the mesh points $x_0, x_1, \ldots, x_n$. The sum of the areas of these trapezoids gives the approximation to the integral.

This approach is simple yet remarkably effective for sufficiently smooth functions. However, like any numerical method, it introduces an error, known as the **truncation error**, which quantifies the deviation from the exact integral. For the trapezoidal rule, the error is approximately

$$
- \frac{(x_n - x_0)\, h^2}{12} \, y^{(2)}(\xi)
$$

for some $\xi \in [x_0, x_n]$, where $y^{(2)}(\xi)$ denotes the second derivative of $y(x)$ at some point $\xi$ in the integration interval. This expression shows that the error decreases quadratically with the step size $h$, assuming $y^{(2)}(x)$ remains bounded. Consequently, halving the step size reduces the error by roughly a factor of four, reflecting the **second-order accuracy** of the method.

Thus, the trapezoidal rule provides a good balance between simplicity and accuracy, particularly for functions that are at least twice continuously differentiable on the interval of integration.

## Solved Problem 14.5

> Apply the trapezoidal rule to approximate the integral of $\sqrt{x}$ over the interval $[1.00, 1.30]$ using six equally spaced subintervals. Then compare the result with the exact value of the integral.

Dividing the interval $[1.00, 1.30]$ into $n = 6$ subintervals gives a step size of $h = 0.05$. The corresponding partition points are:

$$
x_i = 1.00,\ 1.05,\ 1.10,\ 1.15,\ 1.20,\ 1.25,\ 1.30
$$

Evaluating the function $y(x) = \sqrt{x}$ at these points yields:

$$
y_i = 1.00000,\ 1.02470,\ 1.04881,\ 1.07238,\ 1.09545,\ 1.11803,\ 1.14017
$$

Applying the trapezoidal rule:

$$
\int_{1.00}^{1.30} \sqrt{x}\, dx \approx \frac{0.05}{2} \left[y_0 + 2(y_1 + y_2 + y_3 + y_4 + y_5) + y_6\right]
$$

$$
= \frac{0.05}{2} \left[1.00000 + 2(1.02470 + 1.04881 + 1.07238 + 1.09545 + 1.11803) + 1.14017\right]
$$

$$
= \frac{0.05}{2} \left[1.00000 + 2(5.35937) + 1.14017\right] = \frac{0.05}{2} \cdot 12.85891 = 0.32147
$$

The exact value of the integral is:

$$
\int_{1.00}^{1.30} \sqrt{x}\, dx = \frac{2}{3} \left(1.3^{3/2} - 1\right) \approx 0.32149
$$

Thus, the trapezoidal approximation is accurate to five decimal places, with an absolute error of approximately $0.00002$.

## Solved Problem 14.6 

> Derive an estimate of the truncation error of the trapezoidal rule.

To estimate the truncation error of the composite trapezoidal rule, consider approximating the definite integral

$$
\int_a^b y(x)\, dx
$$

by dividing the interval $[a, b]$ into $n$ equal subintervals of width $h = \frac{b - a}{n}$. On each subinterval $[x_i, x_{i+1}]$, the trapezoidal rule approximates the area under $y(x)$ by using a linear segment between $y(x_i)$ and $y(x_{i+1})$, forming a trapezoid. The total error in the approximation comes from the accumulation of local errors over each subinterval.

### Local Truncation Error via Taylor Expansion

Consider a single subinterval $[x_i, x_{i+1}]$, and denote $x = x_i + t$, where $0 \le t \le h$. Let’s expand $y(x)$ about $x_i$ using Taylor’s theorem:

$$
y(x_i + t) = y(x_i) + t y'(x_i) + \frac{t^2}{2} y''(\xi_t),
$$

for some $\xi_t \in [x_i, x_i + t] \subseteq [x_i, x_{i+1}]$.

Now integrate $y(x)$ over the interval:

$$
\int_{x_i}^{x_{i+1}} y(x)\, dx = \int_0^h \left[ y(x_i) + t y'(x_i) + \frac{t^2}{2} y''(\xi_t) \right] dt.
$$

Compute each term separately:

- $\int_0^h y(x_i)\, dt = h y(x_i)$
- $\int_0^h t y'(x_i)\, dt = \frac{h^2}{2} y'(x_i)$
- $\int_0^h \frac{t^2}{2} y''(\xi_t)\, dt = \frac{1}{2} \int_0^h t^2 y''(\xi_t)\, dt$

Since $y''(\xi_t)$ varies with $t$, we can't integrate it exactly, but by the **mean value theorem for integrals**, there exists some point $\xi_i \in [x_i, x_{i+1}]$ such that:

$$
\int_0^h t^2 y''(\xi_t)\, dt = y''(\xi_i) \int_0^h t^2\, dt = y''(\xi_i) \cdot \frac{h^3}{3}.
$$

Thus, the full integral becomes:

$$
\int_{x_i}^{x_{i+1}} y(x)\, dx = h y(x_i) + \frac{h^2}{2} y'(x_i) + \frac{1}{2} \cdot \frac{h^3}{3} y''(\xi_i) = h y(x_i) + \frac{h^2}{2} y'(x_i) + \frac{h^3}{6} y''(\xi_i).
$$

Now consider the **trapezoidal approximation** over the same interval:

$$
\frac{h}{2} \left[ y(x_i) + y(x_{i+1}) \right].
$$

We expand $y(x_{i+1})$ using Taylor's theorem again:

$$
y(x_{i+1}) = y(x_i + h) = y(x_i) + h y'(x_i) + \frac{h^2}{2} y''(\tilde{\xi}_i)
$$

for some $\tilde{\xi}_i \in [x_i, x_{i+1}]$. Substituting into the trapezoidal approximation:

$$
\frac{h}{2} \left[ y(x_i) + y(x_i) + h y'(x_i) + \frac{h^2}{2} y''(\tilde{\xi}_i) \right] = h y(x_i) + \frac{h^2}{2} y'(x_i) + \frac{h^3}{4} y''(\tilde{\xi}_i).
$$

Now subtract the trapezoidal approximation from the exact integral:

$$
E_i = \int_{x_i}^{x_{i+1}} y(x)\, dx - \frac{h}{2} \left[ y(x_i) + y(x_{i+1}) \right]
$$

$$
= \left( h y(x_i) + \frac{h^2}{2} y'(x_i) + \frac{h^3}{6} y''(\xi_i) \right) - \left( h y(x_i) + \frac{h^2}{2} y'(x_i) + \frac{h^3}{4} y''(\tilde{\xi}_i) \right)
$$

$$
= \frac{h^3}{6} y''(\xi_i) - \frac{h^3}{4} y''(\tilde{\xi}_i) = -\frac{h^3}{12} y''(\bar{\xi}_i)
$$

for some $\bar{\xi}_i \in [x_i, x_{i+1}]$, assuming $y''$ is smooth enough to interpolate between $\xi_i$ and $\tilde{\xi}_i$.

### Global Truncation Error

Summing the local errors over all subintervals gives the total truncation error:

$$
E = \sum_{i=0}^{n-1} E_i = -\frac{h^3}{12} \sum_{i=0}^{n-1} y''(\bar{\xi}_i).
$$

Assuming $y''(x)$ is continuous, the sum can be approximated as $n y''(\xi)$ for some $\xi \in [a, b]$. Substituting $nh = b - a$, we obtain the classical global error estimate:

$$
\text{Truncation error} = - \frac{(b - a) h^2}{12} y''(\xi),
$$

where $\xi \in [a, b]$. This result shows that the global error of the trapezoidal rule is proportional to $h^2$ and depends on the second derivative of the integrand.
